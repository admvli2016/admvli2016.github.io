---
title: 自适应布局
date: 2021-12-05 23:39:15
tags: [布局方式,HTML&&CSS]
categories: 前端基础
---

自适应布局实现有多种方式，下面仅列举我使用过的几种

一般而言，自适应布局常在PC端上应用，常常给`html`元素设置一个最小显示宽度 `min-width`，小于这个宽度部分元素被遮挡住（设置了`overflow:hidden`）或者浏览器底部出现横向滚动条。

<!--more-->

## CSS3 `zoom` 属性

![css zoom](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/image-20211202224328822.png)

```html
<!-- index.html -->
<!-- 运行结果: firefox 不能缩放、edge、chrome 可以缩放 -->
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
                <link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
        <title>CSS ZOOM</title>
    </head>
    <body>
        <div style="height: 500px; width: 500px; background-color: black;"></div>
        <script>
            // js 部分代码如下
            // 初始化
            window.onload = function () {
                document.body.style.zoom = 'normal'; // 避免 zoom 尺寸叠加
                let ratio = document.body.clientWidth / 1904;
                document.body.style.zoom = ratio;
            };

            // 函数防抖
            (function () {
                var throttle = function (type, name, obj) {
                    obj = obj || window;
                    var running = false;
                    var func = function () {
                        if (running) {
                            return;
                        }
                        running = true;
                        requestAnimationFrame(function () {
                            obj.dispatchEvent(new CustomEvent(name));
                            running = false;
                        });
                    };
                    obj.addEventListener(type, func);
                };

                // 初始化 - 可以初始化任何事件
                throttle('resize', 'optimizedResize');
            })();

            window.addEventListener('optimizedResize', function () {
                document.body.style.zoom = 'normal';
                let ratio = document.body.clientWidth / 1904;
                document.body.style.zoom = ratio;
            });
        </script>
    </body>
</html>
```



## CSS3 `transform:scale()` 方法

![css transform:scale](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/屏幕截图2021-12-07001434.png)

```html
<!-- index.html -->
<!-- 运行结果: firefox 、edge、chrome 都可以缩放 -->
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
        <title>CSS SCALE</title>
    </head>
    <!-- 缩放原点 -->
    <body style="transform-origin: 0 0;">
        <div style="height: 500px; width: 500px; background-color: black;"></div>
        <script>
            // js 部分代码如下
            // 初始化
            window.onload = function () {
                let radio = document.body.clientWidth / 1904;
                document.body.style.transform = `scale(${radio},${radio})`
            };

            // 函数防抖
            (function () {
                var throttle = function (type, name, obj) {
                    obj = obj || window;
                    var running = false;
                    var func = function () {
                        if (running) {
                            return;
                        }
                        running = true;
                        requestAnimationFrame(function () {
                            obj.dispatchEvent(new CustomEvent(name));
                            running = false;
                        });
                    };
                    obj.addEventListener(type, func);
                };

                // 初始化 - 可以初始化任何事件
                throttle('resize', 'optimizedResize');
            })();

            window.addEventListener('optimizedResize', function () {
                let radio = document.body.clientWidth / 1904;
                document.body.style.transform = `scale(${radio},${radio})`
            });
        </script>
    </body>
</html>
```



## JS 计算缩放比例，对指定元素的布局属性按照缩放比例重新赋值

用途不是很广泛，可用于对方案1和方案2中不随整体自适应的元素单独处理
```js
let ratio = document.body.clientWidth / 1904;
let element = document.getElementById('element');
element.style.height = Math.round(618 * ratio) + 'px';
element.style.width = Math.round(1365 * ratio) + 'px';
element.style.marginTop = Math.round(-30 * ratio) + 'px';
element.style.marginLeft = Math.round(65 * ratio) + 'px';
// element 元素在 1920*1080 分辨率时的布局属性如下：
// {
//    height: 618px;
//    width: 1365px;
//    margin-top: -30px;
//    margin-left: 65px;
// }
```



## OminiBrowser 项目使用的自适应布局方式（兼容不同浏览器）

因为这个项目是自己早期做的，存在很多疏漏，这里仅用作于参照
这里当时并不知道 `transform: scale()` 可以兼容大多数浏览器；不过有一点值得注意的是：**使用`transform: scale()` 进行缩放，会在 `ie`、`edge` 浏览器右侧和底部产生大片空白，**这里使用了一些技巧进行处理，如设置`overflow-x: hidden`、计算出来的高度乘以0.9等

该方案结合了方案1和2，可兼容大部分浏览器，但是对于引入的 Element UI、vis 等插件会有影响，比如 el-select 下拉框位置漂移、图表不跟随此逻辑缩放等，这些问题需要自己再去做兼容处理

```html
<!-- index.html -->
<body style="transform-origin: 0 0;">
    <script type="text/javascript">
        // js 部分代码如下
    </script>
</body>
```

```js
var client = (function () {
  // 呈现引擎
  var engine = {
    ie: 0,
    edge: 0,
    gecko: 0,
    webkit: 0,
    khtml: 0,
    opera: 0
  };
  // 检测呈现引擎、平台和设备
  var ua = navigator.userAgent; // 通过检测用户代理字符串
  if (window.opera) {
    engine.opera = parseFloat(engine.ver);
  } else if (/AppleWebKit\/(\S+)/.test(ua) && ua.indexOf('Edge/') === -1) {
    engine.webkit = parseFloat(engine.ver);
  } else if (/KHTML\/(\S+)/.test(ua) && ua.indexOf('Edge/') === -1) {
    engine.khtml = parseFloat(engine.ver);
  } else if (/rv:([^)]+)\) Gecko\/\d{8}/.test(ua) && ua.indexOf('Edge/') === -1) {
    engine.gecko = parseFloat(engine.ver);
  } else if (!!window.ActiveXObject || 'ActiveXObject' in window) {
    engine.ie = parseFloat(engine.ver);
  } else if (ua.indexOf('Edge/') !== -1) {
    engine.edge = parseFloat(engine.ver);
  }
  return engine;
})();
// 1920 这里也并没有去掉滚动条的宽度，正确的宽度应该是 1920 - 16 = 1904
// screen.width 取的是屏幕的像素宽度，等同于 window.screen.width
var zoomRatio = 1920 / screen.width; 
Object.keys(client).forEach(function (key) {
  if (client[key] !== 0) {
    if (key === 'webkit') {
      // chrome, safari
      document.documentElement.style.zoom = 1 / zoomRatio;
    } else if (key === 'ie') {
      // ie
      document.body.style.zoom = 1 / zoomRatio;
      document.body.style.width = 100 * zoomRatio + '%';
      // 设置为 0.9，是考虑到浏览器导航栏、书签栏的高度以及操作系统底部任务栏的高度，页面实际的高度并没有 1080
      document.body.style.height = 0.9 * (1080 / zoomRatio) + 'px'; // 设置 body 的高度
      document.documentElement.style.height = 0.9 * (1080 / zoomRatio) + 'px'; // 设置 html 元素的高度
      document.documentElement.style.overflowX = 'hidden'; // 设置横向溢出隐藏
    }  else if (key === 'edge') {
      // edge
      document.body.style.zoom = 1 / zoomRatio;
      document.documentElement.style.height = 0.9 * (1080 / zoomRatio) + 'px';
      document.documentElement.style.overflowX = 'hidden';
    } else if (key === 'gecko') {
      // firefox
      document.body.style.transform = 'scale(' + 1 / zoomRatio + ',' + 1 / zoomRatio + ')';
      document.body.style.width = 100 * zoomRatio + '%';
      document.documentElement.style.height = 0.9 * (1080 / zoomRatio) + 'px';
    }
  }
});
```



## rem 布局

![rem 单位](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/image-20211202233703094.png)

rem 布局的关键点在于 `html { font-size: 1vw }` 即将 html 元素的 font-size 设置为 1vw，因为 rem 是基于页面根元素（即 html 元素）的 font-size 计算的，默认情况下，1rem = html 的 font-size 值；在这里就是 1rem = 1vw，因此当视宽 vw 发生变化时，以 rem 做单位的元素也会相应的变化 

### 浮动布局与 rem 布局对比

浮动布局代码如下：

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
    <title>浮动布局</title>
    <style>
        .box {
            float: left;
            width: 400px;
            margin: 50px 25px;
        }
        .box p {
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="box box1">
        <p>
          1，软件部培训总结撰写  √  已完成
          2，自己笔记本shenguyun文件夹整理  √  已完成  
          3，面试经验总结（最后一个）√   已完成 
          4，将各项目需要在53上面发版的步骤总结一下  
            差 Manage 发版内容，等明确了53 Manage 存放的地址加上即可
            ui-app-android 项目配置文件路径
          5，vivo手机文件同步（需要在同一wifi环境下安装手机驱动）
        </p>
    </div>
    <div class="box box2">
        <p>
          1，总结一下 8 月份暂未完成的任务   √  已完成
          2，自己笔记本上需要下载的东西下载好
            公司电脑和自己的笔记本数据同步
            1，软件部培训总结撰写  回去再写 √  已完成  9/5
            2，自己笔记本shenguyun文件夹整理  √  已完成  9/5
            3，chrome 书签备份  √
            4，公司文件夹shenguyun同步 √
          3，面试经验总结（最后一个）√   已完成  9/5
          4，浏览器书签内容整理
          5，将各项目需要在53上面发版的步骤总结一下 
        </p>
    </div> 
    <div class="box box3">
        <p>
          苹果应用市场审核意见：您的应用程序使用第三方登录服务，但不提供Apple登录。使用第三方登录服务进行帐户身份验证的应用程序需要向用户提供使用Apple登录的同等选项。
          下一步请修改您的应用程序，以提供与Apple登录作为帐户身份验证的等效选项。
          将微信登陆按钮隐藏后去审核，审核通过之后，通过热更新将按钮换回来
          上架审核时，可以给界面上的微信登录按钮 设置一个定时器里面设置微信登录按钮隐藏，以便通过审核
        </p>
    </div> 
</body>
</html>
```

页面表现如下：

`1366x768`

![1366x768](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE1.png)

`1200x473`

![1200x473](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(1).png)

`1080x473`

![1080x473](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(2).png)

`ipad pro 1024x1366`

![1024x1366](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE.png)

`960x473`

![960x473](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(3).png)

`ipad 768X1024`

![768x1024](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(4).png)

`iphone6/7/8/plus 414x736`

![414x736](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(5).png)



<hr/>

rem 布局代码如下：

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
  <title>rem 自适应布局</title>
  <style>
    html {
        font-size: 1vw;
    }
    .box {
        float: left;
        width: 29rem;
        margin: 4rem 2rem 0rem 2rem;
    }
    .box p {
        width: 100%;
        /* font-size: 1rem; */  
        /* 继承了html元素的font-size值 大致为 13.66px */
    }
    </style>
</head>
<body>
    <div class="box box1">
        <p>
          1，软件部培训总结撰写  √  已完成
          2，自己笔记本shenguyun文件夹整理  √  已完成  
          3，面试经验总结（最后一个）√   已完成 
          4，将各项目需要在53上面发版的步骤总结一下  
            差 Manage 发版内容，等明确了53 Manage 存放的地址加上即可
            ui-app-android 项目配置文件路径
          5，vivo手机文件同步（需要在同一wifi环境下安装手机驱动）
        </p>
    </div>
    <div class="box box2">
        <p>
          1，总结一下 8 月份暂未完成的任务   √  已完成
          2，自己笔记本上需要下载的东西下载好
            公司电脑和自己的笔记本数据同步
            1，软件部培训总结撰写  回去再写 √  已完成  9/5
            2，自己笔记本shenguyun文件夹整理  √  已完成  9/5
            3，chrome 书签备份  √
            4，公司文件夹shenguyun同步 √
          3，面试经验总结（最后一个）√   已完成  9/5
          4，浏览器书签内容整理
          5，将各项目需要在53上面发版的步骤总结一下 
        </p>
    </div> 
    <div class="box box3">
        <p>
          苹果应用市场审核意见：您的应用程序使用第三方登录服务，但不提供Apple登录。使用第三方登录服务进行帐户身份验证的应用程序需要向用户提供使用Apple登录的同等选项。
          下一步请修改您的应用程序，以提供与Apple登录作为帐户身份验证的等效选项。
          将微信登陆按钮隐藏后去审核，审核通过之后，通过热更新将按钮换回来
          上架审核时，可以给界面上的微信登录按钮 设置一个定时器里面设置微信登录按钮隐藏，以便通过审核
        </p>
    </div> 
</body>
</html>
```

`1366x768`

![1366x768](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(6).png)

`1200x473`

![1200x473](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(7).png)

`1080x473`

![1080x473](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(8).png)

`ipad pro 1024x1366`

![1024x1366](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(9).png)

`960x473`

![960x473](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(10).png)

`ipad 768X1024`

![768x1024](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(11).png)

`iphone6/7/8/plus 414x736`

![414x736](https://admvli2016.oss-cn-shenzhen.aliyuncs.com/img/%E6%88%AA%E5%9B%BE%20(12).png)

对比效果很明显，rem 布局在自适应上更具优势